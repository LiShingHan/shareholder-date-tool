<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>è‚¡æ±æœƒé€šçŸ¥åŠéæˆ¶åœæ­¢æ—¥æœŸè¨ˆç®—å™¨</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    label, select, input { display: block; margin: 1em 0 0.5em; }
    button { padding: 0.5em 1em; }
    .result { margin-top: 1.5em; background: #f8f8f8; padding: 1em; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>ğŸ“… è‚¡æ±æœƒé€šçŸ¥åŠéæˆ¶åœæ­¢æ—¥æœŸè¨ˆç®—å™¨</h2>

  <label for="company">é¸æ“‡å…¬å¸é¡å‹ï¼š</label>
  <select id="company">
    <option value="å…¬é–‹">å…¬é–‹ç™¼è¡Œå…¬å¸</option>
    <option value="éå…¬é–‹">éå…¬é–‹ç™¼è¡Œå…¬å¸</option>
  </select>

  <label for="meeting">é¸æ“‡æœƒè­°é¡å‹ï¼š</label>
  <select id="meeting">
    <option value="å¸¸æœƒ">è‚¡æ±å¸¸æœƒ</option>
    <option value="è‡¨æ™‚æœƒ">è‚¡æ±è‡¨æ™‚æœƒ</option>
  </select>

  <label for="meetingDate">é è¨ˆè‚¡æ±æœƒæ—¥æœŸï¼š</label>
  <input type="date" id="meetingDate" required>

  <button onclick="calculate()">è¨ˆç®—æ—¥æœŸ</button>

  <div class="result" id="output"></div>

  <script>
    function calculate() {
      const company = document.getElementById("company").value;
      const meeting = document.getElementById("meeting").value;
      const dateStr = document.getElementById("meetingDate").value;

      if (!dateStr) {
        alert("è«‹é¸æ“‡è‚¡æ±æœƒæ—¥æœŸ");
        return;
      }

      const meetingDate = new Date(dateStr);
      const output = document.getElementById("output");

      let notifyDays, stopDays = 30;

      // è¨ˆç®—é€šçŸ¥æœŸé™
      if (meeting === "å¸¸æœƒ") {
        notifyDays = company === "å…¬é–‹" ? 30 : 20;
      } else {
        notifyDays = company === "å…¬é–‹" ? 15 : 10;
      }

      // è¨ˆç®—æ—¥æœŸ
      const notifyDate = new Date(meetingDate);
      notifyDate.setDate(notifyDate.getDate() - notifyDays);

      const stopStart = new Date(meetingDate);
      stopStart.setDate(stopStart.getDate() - stopDays);

      // æ ¼å¼åŒ–æ—¥æœŸ
      const fmt = d => d.toISOString().split("T")[0];

      output.innerHTML = `
        <strong>ğŸ“Œ çµæœï¼š</strong><br>
        âœ… éæˆ¶åœæ­¢æœŸé–“ï¼š<b>${fmt(stopStart)}</b> èµ·è‡³ <b>${fmt(meetingDate)}</b><br>
        âœ… æœ€é²å¬é›†é€šçŸ¥å¯„å‡ºæ—¥ï¼š<b>${fmt(notifyDate)}</b><br>
        â³ å¯æ¥å—ææ¡ˆå…¬å‘Šæ—¥å»ºè­°æ—©æ–¼ï¼š<b>${fmt(stopStart)}</b>
      `;
    }
  </script>
</body>
</html>
